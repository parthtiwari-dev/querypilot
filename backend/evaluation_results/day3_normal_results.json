{
  "metadata": {
    "mode": "normal",
    "total_queries": 20,
    "valid_queries": 14,
    "invalid_queries": 6,
    "avg_confidence": 0.77,
    "avg_validation_latency_ms": 3.04,
    "critic_threshold": 0.7
  },
  "results": [
    {
      "id": "simple_001",
      "question": "How many products are in the database?",
      "complexity": "simple",
      "generated_sql": "SELECT COUNT(product_id) FROM products LIMIT 1000",
      "validation": {
        "confidence": 1.0,
        "is_valid": true,
        "issues": [],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": true,
            "issues": []
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": true,
        "error_type": null,
        "error_message": null,
        "execution_time_ms": 22.1,
        "row_count": 1
      },
      "validation_time_ms": 7.83,
      "ground_truth_tables": [
        "products"
      ],
      "retrieved_tables": [
        "products",
        "order_items",
        "reviews"
      ],
      "schema_linking_time_ms": 196.94,
      "sql_generation_time_ms": 276.38
    },
    {
      "id": "simple_002",
      "question": "List all customer names",
      "complexity": "simple",
      "generated_sql": "SELECT name FROM customers LIMIT 1000",
      "validation": {
        "confidence": 1.0,
        "is_valid": true,
        "issues": [],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": true,
            "issues": []
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": true,
        "error_type": null,
        "error_message": null,
        "execution_time_ms": 24.48,
        "row_count": 3
      },
      "validation_time_ms": 1.09,
      "ground_truth_tables": [
        "customers"
      ],
      "retrieved_tables": [
        "customers",
        "orders",
        "reviews"
      ],
      "schema_linking_time_ms": 70.29,
      "sql_generation_time_ms": 133.38
    },
    {
      "id": "simple_003",
      "question": "Show products with price greater than 100",
      "complexity": "simple",
      "generated_sql": "SELECT name, price \nFROM products \nWHERE price::numeric > 100 \nLIMIT 1000",
      "validation": {
        "confidence": 1.0,
        "is_valid": true,
        "issues": [],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": true,
            "issues": []
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": true,
        "error_type": null,
        "error_message": null,
        "execution_time_ms": 15.48,
        "row_count": 1
      },
      "validation_time_ms": 1.83,
      "ground_truth_tables": [
        "products"
      ],
      "retrieved_tables": [
        "products",
        "order_items"
      ],
      "schema_linking_time_ms": 74.98,
      "sql_generation_time_ms": 289.62
    },
    {
      "id": "simple_004",
      "question": "What are the top 5 most expensive products?",
      "complexity": "simple",
      "generated_sql": "SELECT name, price \nFROM products \nORDER BY price::DECIMAL DESC \nLIMIT 5;",
      "validation": {
        "confidence": 1.0,
        "is_valid": true,
        "issues": [],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": true,
            "issues": []
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": true,
        "error_type": null,
        "error_message": null,
        "execution_time_ms": 29.53,
        "row_count": 3
      },
      "validation_time_ms": 2.52,
      "ground_truth_tables": [
        "products"
      ],
      "retrieved_tables": [
        "products",
        "order_items"
      ],
      "schema_linking_time_ms": 86.56,
      "sql_generation_time_ms": 175.96
    },
    {
      "id": "simple_005",
      "question": "Count how many orders have completed status",
      "complexity": "simple",
      "generated_sql": "SELECT COUNT(order_id) \nFROM orders \nWHERE status = 'completed' \nLIMIT 1000;",
      "validation": {
        "confidence": 1.0,
        "is_valid": true,
        "issues": [],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": true,
            "issues": []
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": true,
        "error_type": null,
        "error_message": null,
        "execution_time_ms": 47.64,
        "row_count": 1
      },
      "validation_time_ms": 1.63,
      "ground_truth_tables": [
        "orders"
      ],
      "retrieved_tables": [
        "orders",
        "payments",
        "order_items"
      ],
      "schema_linking_time_ms": 90.97,
      "sql_generation_time_ms": 187.44
    },
    {
      "id": "simple_006",
      "question": "Show all product categories",
      "complexity": "simple",
      "generated_sql": "SELECT DISTINCT p.category_id, c.name \nFROM products p \nJOIN categories c ON p.category_id::INTEGER = c.category_id::INTEGER \nORDER BY c.name \nLIMIT 1000",
      "validation": {
        "confidence": 1.0,
        "is_valid": true,
        "issues": [],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": true,
            "issues": []
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": true,
        "error_type": null,
        "error_message": null,
        "execution_time_ms": 30.45,
        "row_count": 3
      },
      "validation_time_ms": 5.08,
      "ground_truth_tables": [
        "categories"
      ],
      "retrieved_tables": [
        "products",
        "categories"
      ],
      "schema_linking_time_ms": 77.69,
      "sql_generation_time_ms": 240.27
    },
    {
      "id": "simple_007",
      "question": "Find products with low stock (less than 10 units)",
      "complexity": "simple",
      "generated_sql": "SELECT product_id \nFROM products \nWHERE stock_quantity::INTEGER < 10 \nLIMIT 1000",
      "validation": {
        "confidence": 1.0,
        "is_valid": true,
        "issues": [],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": true,
            "issues": []
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": true,
        "error_type": null,
        "error_message": null,
        "execution_time_ms": 20.33,
        "row_count": 0
      },
      "validation_time_ms": 1.81,
      "ground_truth_tables": [
        "products"
      ],
      "retrieved_tables": [
        "products",
        "order_items"
      ],
      "schema_linking_time_ms": 80.8,
      "sql_generation_time_ms": 271.89
    },
    {
      "id": "simple_008",
      "question": "List customers from USA",
      "complexity": "simple",
      "generated_sql": "SELECT customer_id, name, email FROM customers WHERE country ILIKE 'USA' LIMIT 1000",
      "validation": {
        "confidence": 1.0,
        "is_valid": true,
        "issues": [],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": true,
            "issues": []
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": true,
        "error_type": null,
        "error_message": null,
        "execution_time_ms": 76.34,
        "row_count": 1
      },
      "validation_time_ms": 2.59,
      "ground_truth_tables": [
        "customers"
      ],
      "retrieved_tables": [
        "customers",
        "orders",
        "reviews"
      ],
      "schema_linking_time_ms": 74.6,
      "sql_generation_time_ms": 161.12
    },
    {
      "id": "medium_001",
      "question": "What are the top 10 products by revenue?",
      "complexity": "medium",
      "generated_sql": "SELECT p.product_id, SUM(oi.subtotal) AS revenue \nFROM products p \nJOIN order_items oi ON p.product_id = oi.product_id::INTEGER \nGROUP BY p.product_id \nORDER BY revenue DESC \nLIMIT 10;",
      "validation": {
        "confidence": 1.0,
        "is_valid": true,
        "issues": [],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": true,
            "issues": []
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": true,
        "error_type": null,
        "error_message": null,
        "execution_time_ms": 82.64,
        "row_count": 3
      },
      "validation_time_ms": 2.18,
      "ground_truth_tables": [
        "products",
        "order_items"
      ],
      "retrieved_tables": [
        "products",
        "order_items"
      ],
      "schema_linking_time_ms": 79.71,
      "sql_generation_time_ms": 361.55
    },
    {
      "id": "medium_002",
      "question": "Show customers and their total order count",
      "complexity": "medium",
      "generated_sql": "SELECT customer_id, COUNT(*) AS total_order_count \nFROM orders \nGROUP BY customer_id \nORDER BY total_order_count DESC \nLIMIT 1000",
      "validation": {
        "confidence": 1.0,
        "is_valid": true,
        "issues": [],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": true,
            "issues": []
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": true,
        "error_type": null,
        "error_message": null,
        "execution_time_ms": 31.23,
        "row_count": 3
      },
      "validation_time_ms": 2.93,
      "ground_truth_tables": [
        "customers",
        "orders"
      ],
      "retrieved_tables": [
        "orders",
        "order_items",
        "payments"
      ],
      "schema_linking_time_ms": 69.67,
      "sql_generation_time_ms": 281.68
    },
    {
      "id": "medium_003",
      "question": "Calculate total revenue by product category",
      "complexity": "medium",
      "generated_sql": "SELECT category_id, SUM(subtotal) AS total_revenue \nFROM order_items \nJOIN products ON order_items.product_id = products.id \nGROUP BY category_id \nORDER BY total_revenue DESC \nLIMIT 1000; \n\n-- TODO: Missing table or column: product_id in order_items table and id in products table",
      "validation": {
        "confidence": 0.19999999999999996,
        "is_valid": false,
        "issues": [
          "Column 'product_id' not in table 'order_items' (available: subtotal...)",
          "Column 'id' not in table 'products' (available: stock_quantity, price, category_id...)"
        ],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": false,
            "issues": [
              "Column 'product_id' not in table 'order_items' (available: subtotal...)",
              "Column 'id' not in table 'products' (available: stock_quantity, price, category_id...)"
            ]
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": null,
        "skipped": true,
        "reason": "Failed validation"
      },
      "validation_time_ms": 2.51,
      "ground_truth_tables": [
        "categories",
        "products",
        "order_items"
      ],
      "retrieved_tables": [
        "products",
        "orders",
        "order_items"
      ],
      "schema_linking_time_ms": 83.61,
      "sql_generation_time_ms": 404.04
    },
    {
      "id": "medium_004",
      "question": "Find products that have never been ordered",
      "complexity": "medium",
      "generated_sql": "SELECT product_id \nFROM products \nWHERE product_id NOT IN (SELECT product_id FROM order_items)\nLIMIT 1000",
      "validation": {
        "confidence": 0.8,
        "is_valid": true,
        "issues": [
          "Multiple tables detected but no JOIN found (possible cartesian product)"
        ],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": true,
            "issues": []
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": false,
            "issues": [
              "Multiple tables detected but no JOIN found (possible cartesian product)"
            ]
          }
        }
      },
      "execution": {
        "success": true,
        "error_type": null,
        "error_message": null,
        "execution_time_ms": 40.96,
        "row_count": 0
      },
      "validation_time_ms": 1.62,
      "ground_truth_tables": [
        "products",
        "order_items"
      ],
      "retrieved_tables": [
        "order_items",
        "products",
        "reviews",
        "orders"
      ],
      "schema_linking_time_ms": 60.96,
      "sql_generation_time_ms": 187.23
    },
    {
      "id": "medium_005",
      "question": "Show average order value by customer",
      "complexity": "medium",
      "generated_sql": "SELECT customer_id, AVG(total_amount) AS average_order_value \nFROM orders \nGROUP BY customer_id \nORDER BY average_order_value DESC \nLIMIT 1000",
      "validation": {
        "confidence": 1.0,
        "is_valid": true,
        "issues": [],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": true,
            "issues": []
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": true,
        "error_type": null,
        "error_message": null,
        "execution_time_ms": 31.71,
        "row_count": 3
      },
      "validation_time_ms": 2.18,
      "ground_truth_tables": [
        "customers",
        "orders"
      ],
      "retrieved_tables": [
        "orders",
        "order_items",
        "customers"
      ],
      "schema_linking_time_ms": 72.89,
      "sql_generation_time_ms": 297.43
    },
    {
      "id": "medium_006",
      "question": "List products with their average review rating",
      "complexity": "medium",
      "generated_sql": "SELECT product_id, AVG(rating::FLOAT) AS average_rating \nFROM reviews \nGROUP BY product_id \nORDER BY average_rating DESC \nLIMIT 1000",
      "validation": {
        "confidence": 1.0,
        "is_valid": true,
        "issues": [],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": true,
            "issues": []
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": true,
        "error_type": null,
        "error_message": null,
        "execution_time_ms": 43.16,
        "row_count": 0
      },
      "validation_time_ms": 1.43,
      "ground_truth_tables": [
        "products",
        "reviews"
      ],
      "retrieved_tables": [
        "reviews"
      ],
      "schema_linking_time_ms": 74.46,
      "sql_generation_time_ms": 301.09
    },
    {
      "id": "medium_007",
      "question": "Count orders per payment method",
      "complexity": "medium",
      "generated_sql": "SELECT payment_method, COUNT(DISTINCT order_id) AS order_count \nFROM payments \nGROUP BY payment_method \nORDER BY order_count DESC \nLIMIT 1000",
      "validation": {
        "confidence": 1.0,
        "is_valid": true,
        "issues": [],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": true,
            "issues": []
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": true,
        "error_type": null,
        "error_message": null,
        "execution_time_ms": 28.24,
        "row_count": 2
      },
      "validation_time_ms": 2.53,
      "ground_truth_tables": [
        "orders",
        "payments"
      ],
      "retrieved_tables": [
        "payments",
        "orders"
      ],
      "schema_linking_time_ms": 74.28,
      "sql_generation_time_ms": 206.22
    },
    {
      "id": "medium_008",
      "question": "Show total quantity sold for each product",
      "complexity": "medium",
      "generated_sql": "SELECT SUM(oi.quantity) AS total_quantity_sold\nFROM order_items oi\nGROUP BY oi.quantity\nLIMIT 1000; \n\n-- TODO: Missing table to link order_items to products, assuming a product_id column is needed in order_items table to correctly group by product. \n\n-- Alternative query with correct join if product_id exists in order_items:\n-- SELECT p.price, SUM(oi.quantity) AS total_quantity_sold\n-- FROM order_items oi\n-- JOIN products p ON oi.product_id = p.product_id\n-- GROUP BY p.product_id, p.price\n-- LIMIT 1000;",
      "validation": {
        "confidence": 0.0,
        "is_valid": false,
        "issues": [
          "Table 'if' not in schema (available: order_items, orders, products)",
          "Column 'product_id' not in table 'order_items' (available: subtotal, quantity...)",
          "Column 'product_id' not in table 'products' (available: stock_quantity, price...)",
          "Unsafe operation detected: ALTER"
        ],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": false,
            "issues": [
              "Table 'if' not in schema (available: order_items, orders, products)",
              "Column 'product_id' not in table 'order_items' (available: subtotal, quantity...)",
              "Column 'product_id' not in table 'products' (available: stock_quantity, price...)"
            ]
          },
          "safety": {
            "valid": false,
            "issues": [
              "Unsafe operation detected: ALTER"
            ]
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": null,
        "skipped": true,
        "reason": "Failed validation"
      },
      "validation_time_ms": 3.13,
      "ground_truth_tables": [
        "products",
        "order_items"
      ],
      "retrieved_tables": [
        "order_items",
        "products",
        "orders"
      ],
      "schema_linking_time_ms": 90.81,
      "sql_generation_time_ms": 642.77
    },
    {
      "id": "hard_001",
      "question": "Find customers who have placed more orders than average",
      "complexity": "hard",
      "generated_sql": "SELECT c.name \nFROM customers c\nJOIN orders o ON c.customer_id = o.customer_id\nGROUP BY c.name\nHAVING COUNT(o.customer_id) > (SELECT AVG(order_count) \n                                FROM (SELECT customer_id, COUNT(customer_id) AS order_count \n                                      FROM orders \n                                      GROUP BY customer_id) AS subquery)\nLIMIT 1000",
      "validation": {
        "confidence": 0.6,
        "is_valid": false,
        "issues": [
          "Column 'customer_id' not in table 'customers' (available: lifetime_value, name...)"
        ],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": false,
            "issues": [
              "Column 'customer_id' not in table 'customers' (available: lifetime_value, name...)"
            ]
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": null,
        "skipped": true,
        "reason": "Failed validation"
      },
      "validation_time_ms": 5.19,
      "ground_truth_tables": [
        "customers",
        "orders"
      ],
      "retrieved_tables": [
        "orders",
        "order_items",
        "customers",
        "payments"
      ],
      "schema_linking_time_ms": 82.86,
      "sql_generation_time_ms": 291.39
    },
    {
      "id": "hard_002",
      "question": "Show monthly revenue trend for the last 6 months",
      "complexity": "hard",
      "generated_sql": "SELECT \n    DATE_TRUNC('month', payment_date) AS month,\n    SUM(amount) AS revenue\nFROM \n    payments\nWHERE \n    payment_date >= CURRENT_DATE - INTERVAL '6 month'\nGROUP BY \n    DATE_TRUNC('month', payment_date)\nORDER BY \n    month\nLIMIT 1000",
      "validation": {
        "confidence": 0.6,
        "is_valid": false,
        "issues": [
          "Column 'date_trunc('month'' not in table 'payments' (available: payment_date, amount...)"
        ],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": false,
            "issues": [
              "Column 'date_trunc('month'' not in table 'payments' (available: payment_date, amount...)"
            ]
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": null,
        "skipped": true,
        "reason": "Failed validation"
      },
      "validation_time_ms": 4.39,
      "ground_truth_tables": [
        "orders",
        "order_items"
      ],
      "retrieved_tables": [
        "customers",
        "orders",
        "payments",
        "order_items"
      ],
      "schema_linking_time_ms": 81.71,
      "sql_generation_time_ms": 250.01
    },
    {
      "id": "hard_003",
      "question": "Rank products by revenue within each category",
      "complexity": "hard",
      "generated_sql": "SELECT category_id, product_id, SUM(price * stock_quantity) AS revenue\nFROM products\nJOIN order_items ON products.product_id = order_items.product_id\nGROUP BY category_id, product_id\nORDER BY category_id, revenue DESC\nLIMIT 1000",
      "validation": {
        "confidence": 0.19999999999999996,
        "is_valid": false,
        "issues": [
          "Column 'product_id' not in table 'products' (available: stock_quantity, price, category_id...)",
          "Column 'product_id' not in table 'order_items' (available: ...)"
        ],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": false,
            "issues": [
              "Column 'product_id' not in table 'products' (available: stock_quantity, price, category_id...)",
              "Column 'product_id' not in table 'order_items' (available: ...)"
            ]
          },
          "safety": {
            "valid": true,
            "issues": []
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": null,
        "skipped": true,
        "reason": "Failed validation"
      },
      "validation_time_ms": 3.37,
      "ground_truth_tables": [
        "categories",
        "products",
        "order_items"
      ],
      "retrieved_tables": [
        "products",
        "order_items",
        "reviews"
      ],
      "schema_linking_time_ms": 73.83,
      "sql_generation_time_ms": 211.5
    },
    {
      "id": "hard_004",
      "question": "Identify customers who haven't ordered in the last 90 days",
      "complexity": "hard",
      "generated_sql": "SELECT c.customer_id, c.name \nFROM customers c \nLEFT JOIN orders o ON c.customer_id = o.customer_id \nWHERE o.customer_id IS NULL OR o.customer_id NOT IN (\n  SELECT customer_id \n  FROM orders \n  WHERE CURRENT_DATE - created_at::DATE <= INTERVAL '90 day'\n)\nLIMIT 1000",
      "validation": {
        "confidence": 0.0,
        "is_valid": false,
        "issues": [
          "Unsafe operation detected: CREATE"
        ],
        "layer_results": {
          "syntax": {
            "valid": true,
            "issues": []
          },
          "schema": {
            "valid": true,
            "issues": []
          },
          "safety": {
            "valid": false,
            "issues": [
              "Unsafe operation detected: CREATE"
            ]
          },
          "semantic": {
            "valid": true,
            "issues": []
          }
        }
      },
      "execution": {
        "success": null,
        "skipped": true,
        "reason": "Failed validation"
      },
      "validation_time_ms": 5.0,
      "ground_truth_tables": [
        "customers",
        "orders"
      ],
      "retrieved_tables": [
        "orders",
        "customers"
      ],
      "schema_linking_time_ms": 84.77,
      "sql_generation_time_ms": 315.2
    }
  ]
}