{
  "timestamp": "2026-02-18T03:35:34.638119",
  "dataset": "backend/app/evaluation/datasets/core_eval.json",
  "total_tests": 20,
  "summary": {
    "first_attempt_success": 19,
    "first_attempt_rate": 0.95,
    "corrected_success": 0,
    "correction_effectiveness": 0.0,
    "final_failures": 1,
    "overall_success_rate": 0.95,
    "avg_attempts": 1.05,
    "total_attempts": 21
  },
  "criteria": {
    "first_attempt_above_30": true,
    "correction_above_60": false,
    "overall_above_85": true,
    "all_passed": false
  },
  "category_breakdown": {
    "core_eval": {
      "total": 20,
      "first_success": 19,
      "corrected": 0,
      "failed": 1
    }
  },
  "detailed_results": [
    {
      "test_id": "simple_001",
      "question": "How many products are in the database?",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT COUNT(product_id) AS total_products FROM products LIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [
          {
            "total_products": 3
          }
        ],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 54.58,
        "row_count": 1
      },
      "validation_issues": []
    },
    {
      "test_id": "simple_002",
      "question": "List all customer names",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT name FROM customers LIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [
          {
            "name": "Alice Johnson"
          },
          {
            "name": "Bob Smith"
          },
          {
            "name": "Charlie Brown"
          }
        ],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 8.5,
        "row_count": 3
      },
      "validation_issues": []
    },
    {
      "test_id": "simple_003",
      "question": "Show products with price greater than 100",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT product_id, name, price FROM products WHERE price > 100 LIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [
          {
            "product_id": 1,
            "name": "Laptop",
            "price": "999.99"
          }
        ],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 3.44,
        "row_count": 1
      },
      "validation_issues": []
    },
    {
      "test_id": "simple_004",
      "question": "What are the top 5 most expensive products?",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT product_id, name, price \nFROM products \nORDER BY price DESC \nLIMIT 5;",
      "execution_result": {
        "success": true,
        "data": [
          {
            "product_id": 1,
            "name": "Laptop",
            "price": "999.99"
          },
          {
            "product_id": 3,
            "name": "Python Programming Book",
            "price": "39.99"
          },
          {
            "product_id": 2,
            "name": "T-Shirt",
            "price": "29.99"
          }
        ],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 7.05,
        "row_count": 3
      },
      "validation_issues": []
    },
    {
      "test_id": "simple_005",
      "question": "Count how many orders have completed status",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT COUNT(*) AS completed_orders_count \nFROM orders \nWHERE status = 'completed' \nLIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [
          {
            "completed_orders_count": 2
          }
        ],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 12.73,
        "row_count": 1
      },
      "validation_issues": []
    },
    {
      "test_id": "simple_006",
      "question": "Show all product categories",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT category_id, name, description FROM categories LIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [
          {
            "category_id": 1,
            "name": "Electronics",
            "description": "Electronic devices and accessories"
          },
          {
            "category_id": 2,
            "name": "Clothing",
            "description": "Apparel and fashion items"
          },
          {
            "category_id": 3,
            "name": "Books",
            "description": "Physical and digital books"
          }
        ],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 7.5,
        "row_count": 3
      },
      "validation_issues": []
    },
    {
      "test_id": "simple_007",
      "question": "Find products with low stock (less than 10 units)",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT product_id, name, stock_quantity \nFROM products \nWHERE stock_quantity < 10 \nORDER BY stock_quantity \nLIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 4.98,
        "row_count": 0
      },
      "validation_issues": []
    },
    {
      "test_id": "simple_008",
      "question": "List customers from USA",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT customer_id, name, email, created_at, country, lifetime_value \nFROM customers \nWHERE country ILIKE 'USA' \nLIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [
          {
            "customer_id": 1,
            "name": "Alice Johnson",
            "email": "alice@example.com",
            "created_at": "2026-02-17 21:17:02.742377",
            "country": "USA",
            "lifetime_value": "1250.00"
          }
        ],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 8.45,
        "row_count": 1
      },
      "validation_issues": []
    },
    {
      "test_id": "medium_001",
      "question": "What are the top 10 products by revenue?",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT p.product_id, p.name, SUM(oi.subtotal) AS total_revenue\nFROM products p\nJOIN order_items oi ON p.product_id = oi.product_id\nGROUP BY p.product_id, p.name\nORDER BY total_revenue DESC\nLIMIT 10;",
      "execution_result": {
        "success": true,
        "data": [
          {
            "product_id": 1,
            "name": "Laptop",
            "total_revenue": "999.99"
          },
          {
            "product_id": 3,
            "name": "Python Programming Book",
            "total_revenue": "39.99"
          },
          {
            "product_id": 2,
            "name": "T-Shirt",
            "total_revenue": "29.99"
          }
        ],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 7.87,
        "row_count": 3
      },
      "validation_issues": []
    },
    {
      "test_id": "medium_002",
      "question": "Show customers and their total order count",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT c.customer_id, c.name, COUNT(o.order_id) AS total_order_count\nFROM customers c\nLEFT JOIN orders o ON c.customer_id = o.customer_id\nGROUP BY c.customer_id, c.name\nORDER BY total_order_count DESC\nLIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [
          {
            "customer_id": 3,
            "name": "Charlie Brown",
            "total_order_count": 1
          },
          {
            "customer_id": 2,
            "name": "Bob Smith",
            "total_order_count": 1
          },
          {
            "customer_id": 1,
            "name": "Alice Johnson",
            "total_order_count": 1
          }
        ],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 7.2,
        "row_count": 3
      },
      "validation_issues": []
    },
    {
      "test_id": "medium_003",
      "question": "Calculate total revenue by product category",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT c.name AS category_name, SUM(oi.subtotal) AS total_revenue\nFROM categories c\nJOIN products p ON c.category_id = p.category_id\nJOIN order_items oi ON p.product_id = oi.product_id\nGROUP BY c.category_id, c.name\nORDER BY total_revenue DESC\nLIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [
          {
            "category_name": "Electronics",
            "total_revenue": "999.99"
          },
          {
            "category_name": "Books",
            "total_revenue": "39.99"
          },
          {
            "category_name": "Clothing",
            "total_revenue": "29.99"
          }
        ],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 6.29,
        "row_count": 3
      },
      "validation_issues": []
    },
    {
      "test_id": "medium_004",
      "question": "Find products that have never been ordered",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT p.product_id, p.name, p.price \nFROM products p \nLEFT JOIN order_items oi ON p.product_id = oi.product_id \nWHERE oi.order_item_id IS NULL \nLIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 5.67,
        "row_count": 0
      },
      "validation_issues": []
    },
    {
      "test_id": "medium_005",
      "question": "Show average order value by customer",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT c.customer_id, c.name, AVG(o.total_amount) AS average_order_value\nFROM customers c\nJOIN orders o ON c.customer_id = o.customer_id\nGROUP BY c.customer_id, c.name\nLIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [
          {
            "customer_id": 3,
            "name": "Charlie Brown",
            "average_order_value": "39.9900000000000000"
          },
          {
            "customer_id": 2,
            "name": "Bob Smith",
            "average_order_value": "29.9900000000000000"
          },
          {
            "customer_id": 1,
            "name": "Alice Johnson",
            "average_order_value": "999.9900000000000000"
          }
        ],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 7.02,
        "row_count": 3
      },
      "validation_issues": []
    },
    {
      "test_id": "medium_006",
      "question": "List products with their average review rating",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT p.product_id, p.name, AVG(r.rating) AS average_rating\nFROM products p\nLEFT JOIN reviews r ON p.product_id = r.product_id\nGROUP BY p.product_id, p.name\nORDER BY p.product_id\nLIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [
          {
            "product_id": 1,
            "name": "Laptop",
            "average_rating": null
          },
          {
            "product_id": 2,
            "name": "T-Shirt",
            "average_rating": null
          },
          {
            "product_id": 3,
            "name": "Python Programming Book",
            "average_rating": null
          }
        ],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 6.04,
        "row_count": 3
      },
      "validation_issues": []
    },
    {
      "test_id": "medium_007",
      "question": "Count orders per payment method",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": false,
      "attempts": 2,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT payment_method, COUNT(order_id) AS order_count\nFROM payments\nJOIN orders ON payments.order_id = orders.order_id\nGROUP BY payment_method\nORDER BY order_count DESC\nLIMIT 1000;",
      "execution_result": {
        "success": false,
        "data": null,
        "error_type": "join_error",
        "error_message": "(psycopg2.errors.AmbiguousColumn) column reference \"order_id\" is ambiguous\nLINE 1: SELECT payment_method, COUNT(order_id) AS order_count\n                                     ^\n\n[SQL: SELECT payment_method, COUNT(order_id) AS order_count\nFROM payments\nJOIN orders ON payments.order_id = orders.order_id\nGROUP BY payment_method\nORDER BY order_count DESC\nLIMIT 1000]\n(Background on this error at: https://sqlalche.me/e/20/f405)",
        "error_feedback": "JOIN error - column reference is ambiguous. Use table aliases (e.g., p.product_id, o.order_id) to clarify which table's column.",
        "execution_time_ms": 4.36,
        "row_count": 0
      },
      "validation_issues": []
    },
    {
      "test_id": "medium_008",
      "question": "Show total quantity sold for each product",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT oi.product_id, SUM(oi.quantity) AS total_quantity_sold\nFROM order_items oi\nGROUP BY oi.product_id\nORDER BY total_quantity_sold DESC\nLIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [
          {
            "product_id": 3,
            "total_quantity_sold": 1
          },
          {
            "product_id": 2,
            "total_quantity_sold": 1
          },
          {
            "product_id": 1,
            "total_quantity_sold": 1
          }
        ],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 6.81,
        "row_count": 3
      },
      "validation_issues": []
    },
    {
      "test_id": "hard_001",
      "question": "Find customers who have placed more orders than average",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "WITH average_order_count AS (\n    SELECT AVG(order_count) AS avg_count\n    FROM (\n        SELECT customer_id, COUNT(order_id) AS order_count\n        FROM orders\n        GROUP BY customer_id\n    ) AS customer_orders\n)\nSELECT c.customer_id, c.name, COUNT(o.order_id) AS order_count\nFROM customers c\nJOIN orders o ON c.customer_id = o.customer_id\nGROUP BY c.customer_id, c.name\nHAVING COUNT(o.order_id) > (SELECT avg_count FROM average_order_count)\nORDER BY order_count DESC\nLIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 5.36,
        "row_count": 0
      },
      "validation_issues": []
    },
    {
      "test_id": "hard_002",
      "question": "Show monthly revenue trend for the last 6 months",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "WITH monthly_revenue AS (\n    SELECT \n        DATE_TRUNC('month', o.order_date) AS month,\n        SUM(o.total_amount) AS total_revenue\n    FROM \n        orders o\n    WHERE \n        o.order_date >= CURRENT_DATE - INTERVAL '6 months'\n    GROUP BY \n        month\n)\nSELECT \n    month, \n    total_revenue\nFROM \n    monthly_revenue\nORDER BY \n    month\nLIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [
          {
            "month": "2026-02-01 00:00:00",
            "total_revenue": "1069.97"
          }
        ],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 7.97,
        "row_count": 1
      },
      "validation_issues": []
    },
    {
      "test_id": "hard_003",
      "question": "Rank products by revenue within each category",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "WITH category_revenue AS (\n    SELECT \n        p.category_id,\n        p.product_id,\n        SUM(oi.subtotal) AS total_revenue\n    FROM \n        products p\n    JOIN \n        order_items oi ON p.product_id = oi.product_id\n    GROUP BY \n        p.category_id, p.product_id\n)\nSELECT \n    cr.category_id,\n    p.name,\n    cr.total_revenue\nFROM \n    category_revenue cr\nJOIN \n    products p ON cr.product_id = p.product_id\nORDER BY \n    cr.category_id, cr.total_revenue DESC\nLIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [
          {
            "category_id": 1,
            "name": "Laptop",
            "total_revenue": "999.99"
          },
          {
            "category_id": 2,
            "name": "T-Shirt",
            "total_revenue": "29.99"
          },
          {
            "category_id": 3,
            "name": "Python Programming Book",
            "total_revenue": "39.99"
          }
        ],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 4.98,
        "row_count": 3
      },
      "validation_issues": []
    },
    {
      "test_id": "hard_004",
      "question": "Identify customers who haven't ordered in the last 90 days",
      "category": "core_eval",
      "expected_error": "N/A",
      "should_succeed": true,
      "actual_success": true,
      "attempts": 1,
      "was_corrected": false,
      "used_fallback": false,
      "final_sql": "SELECT c.customer_id, c.name, c.email, c.created_at, c.country, c.lifetime_value\nFROM customers c\nLEFT JOIN orders o ON c.customer_id = o.customer_id AND o.order_date >= CURRENT_DATE - INTERVAL '90 days'\nWHERE o.order_id IS NULL\nLIMIT 1000;",
      "execution_result": {
        "success": true,
        "data": [],
        "error_type": null,
        "error_message": null,
        "error_feedback": null,
        "execution_time_ms": 5.47,
        "row_count": 0
      },
      "validation_issues": []
    }
  ]
}